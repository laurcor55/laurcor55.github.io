<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Lauren Corbin Goodman, PhD</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../minimal.css" >
    <link rel="stylesheet" type="text/css" href="../minimal-inputs.css" >
    <link rel="stylesheet" type="text/css" href="../laren.css" >
  </head>
  <body>
    <h1>Lauren Corbin Goodman, PhD</h1>
    <p>Recent Biomedical Engineering PhD graduate with a passion for modeling complex biochemical reactions.</p>
    <button class="fit" 
      onclick="window.location.href = '../index.html';">
      home
    </button>
    <div id="bacteria_growth">
      <h2>Bacteria growth with parallel architecture in C</h2>
      <h3>Background</h3>
      <p>
        This is from the final project for BME590 Parallel Computing course taught by Amanda Randles at Duke University. I did this in collaboration with Helena Ma. For this project, we needed to parallelize a previously developed biomedical computational model. For the sake of learning, it was not allowed to be embarrassingly parallel. We decided to create our own biomedical computational model for bacterial growth and antibiotic resistance. We wrote this work into an unpublished <a href="../media/BME590_Final_Paper.pdf">paper</a>.
      </p>

      <figure>
        <img src='../media/BME590_Final_Paper_screenshot.png', width=1000>
      </figure>
      
      <h3>Model Overview</h3>
      <p>Our bacterial growth model was inspired by Conway's game of life. In short, we set up a 2d grid with each pixel representing a potential habitat for a single bacterium. We seeded the grid sparsely with bacteria. When a bacterium divided, the offspring would inhabit a pixel neighboring the parent.</p>

      <p>In addition, we added antibiotic to the bacteria grid. The antibiotic could diffuse over the grid and would kill local bacteria if above the minimum inhibitory concentration (MIC). To combat the antibiotic, the bacteria could be resistant to it. Our model included two bacteria phenotypes -- antibiotic resistant and wild type. The antibiotic resistant bacteria could degrade the antibiotic, producing a localized antibiotic sink. The wild type bacteria was harmed by the antibiotic, but could benefit from living near the antibiotic resistant bacteria and its sink. Below is a table of the model's parameters. </p>
      <figure>
        <img src='../media/bacteria_division_parameters.png', width=800>
      </figure>

      <p>We used a Monte Carlo approach in C to implement the base model. A 2d grid was seeded with antibiotic and bacteria. For each time step, our model calculated the antibiotic concentration across the grid based off basic 2D diffusion equations. It adjusted antibiotic concentrations from off degradation by antibiotic resistant bacteria. The cells bacteria could then die with some probability. Finally, the cells that were still alive could switch phenotypes and/or divide with some probability. Below is pseudocode for the algorithm flow.
        <pre>
        Import cell_type; \\
        Seed antibiotic_conc;
        while (t_current  &lt; t_total){
          antibiotic_diffusion(antibiotic_conc);
          antibiotic_degradation(antibiotic_conc, cell_type);
          cell_death(cell_type, antibiotic_conc);
          cell_switching(cell_type);
          cell_division(cell_type);
          t_current += dt;
        }
      </pre></p>

      <p>Below is an image representation from the output of the app. The left panel shows snapshots of cells on a 2d grid. Time increases from left to right and top to bottom. Dark blue spot are empty spaces. Cyan spots are wild type cells, and yellow spots are antibiotic resistant cells. The right panel shows antibiotic concentration over the grid at the corresponding times. Yellow is high antibiotic concentration. Cyan is low concentration. Dark blue is no antibiotic. The 2d grid was seeded with cells in horizontal stripes and antibiotic in vertical stripes. Over time, the antibiotic disperses and is degraded by the antibiotic resistant cells. The cells increase in number.</p>

      <figure>
        <img src='../media/bacteria_division_over_time.png', width=1000>
      </figure>

      <p>Below is a plot of cell phenotype over time from the same run. Both phenotypes increase over time despite the antibiotic. This is due to the antibiotic resistant cells degrading the local antibiotic.</p>

      <figure>
        <img src='../media/bacteria_division_over_time_plot.png', width=700>
      </figure>
      <h3>Program Overview</h3>
      <p>This program was written in C. The serial version of the program is available on <a href="https://gitlab.oit.duke.edu/lcc33/bme590_finalproject/-/tree/master">GitLab.</a> It can be accessed through the "model.c" file. </p>

      <h4>Parallelization</h4>
      <p>
        This model was parallelized with MPI. This code availble on the <a href="https://gitlab.oit.duke.edu/lcc33/bme590_finalproject/-/tree/parallel"> "parallel" branch.</a> To parallelize the model, we divided the computing responsibility of 2d grid between several processors. For each time step, individual processors would compute the outcome of a chunk of the grid. The processors would then communicate with each other to share boundary conditions. Below is a scheme of this algorithm.
      </p>
      <figure>
        <img src='../media/bacteria_division_scheme.png', width=700>
        <figcaption> Depiction of serial and parallel architecture and domain decomposition for an r x c lattice where each node in the parallel architecture handles r/n rows. Halo exchanges occur between adjacent nodes while the master node handles output</figcaption>
      </figure>

      <p>
        Because of the stochastic nature of our model, we needed a random number generator that would perform well with MPI. Traditional random number generators create a bottleneck in the parallel flow of the program, as each process has to pull random numbers from a single source. To overcome this, we implemented the <a href="http://www.sprng.org/">Scalable Parallel Random Number Generators (SPRNG) Library.</a> This added an extra layer of difficulty, as we needed to ensure the library was properly configured on each machine and each aspect of our program.
      </p>
      <h4>High Performance Computing</h4>
      <p>This program was developed to run on Microsoft Azure and the Stampede2 super computer at the Texas Advanced Computing Center with OpenMPI. It was tested with 2 to 32 processors. </p>

      <figure>
        <img src='../media/bacteria_division_strong_scaling.png', width=700>
        <figcaption> Strong scaling with speedup (orange) and runtime (blue) on a 1000x1000 board for 3600 seconds.</figcaption>
      </figure>

      <figure>
        <img src='../media/bacteria_division_weak_scaling.png', width=700>
        <figcaption>  Weak scaling on number of rows, number of columns, and number of timesteps. Constants for number of columns: 100 rows, 600 timesteps. For number of columns: 100 columns, 600 timesteps. For number of timesteps: 100 rows, 100 columns.</figcaption>
      </figure>


      <figure>
        <img src='../media/bacteria_division_performance.png', width=700>
        <figcaption>Performance model of parallelization scheme for each time step. <ul>
          <li>r - number of rows in 2D grid</li>
          <li>c - number of columns in 2D grid</li>
          <li>n - number of processors</li>
          <li>T - number of time steps</li>
        </ul> </figcaption>
      </figure>

      <figure>
        <img src='../media/bacteria_division_performance.png', width=700>
        <figcaption>Overall performance model  , F is the time for one floating point operation, I
          is the time for one comparison, and R is the time for one random
          number generation <ul>
          <li>M - for one memory access</li>
          <li>F - time for one floating point operation</li>
          <li>I - time for one comparison</li>
          <li>R - time for one random number generation</li>
        </ul> </figcaption>
      </figure>
      <h3>Skills Developed</h3>
      <ul>
        <li>Parallel processing</li>
        <li>C</li>
        <li>Bash</li>
        <li>Slurm workload manager</li>
        <li>High performance computing</li>
        <li>Performance modeling</li>
      </ul>
    </div>
  </body>

</html>
